<div style="display: flex; align-items: center; gap: 8px;">
  <button
    id="volume-button"
    class="flexy-button flexy-button--circular flexy-button--primary"
  >
    <span class="material-symbol volume-up">
      {{ partial "material-symbol.html" "volume_up-fill/rounded/400/Mute Volume" }}
    </span>
    <span class="material-symbol volume-off" hidden>
      {{ partial "material-symbol.html" "volume_off-fill/rounded/400/Unmute Volume" }}
    </span>
  </button>

  <div class="flexy-slider">
    <input id="volume-slider" type="range" class="flexy-slider__input" />
    <div class="flexy-slider__track">
      <div class="flexy-slider__inactive-track"></div>
      <div class="flexy-slider__active-track"></div>
    </div>
    <div class="flexy-slider__thumb-rail">
      <div class="flexy-slider__thumb">
        <div class="flexy-slider__thumb-knob"></div>
      </div>
    </div>
  </div>
</div>

<script type="module">
  const btn = document.getElementById('volume-button');
  const input = document.getElementById('volume-slider');

  const muteIcon = btn.querySelector('.volume-off');
  const unmuteIcon = btn.querySelector('.volume-up');

  btn.addEventListener('click', () => {
    if (input.value == input.min) {
      input.value = input.dataset.previousValue || (input.max - input.min) / 2;
      input.dataset.previousValue == '';
    } else {
      input.dataset.previousValue = input.value;
      input.value = input.min;
    }
    input.dispatchEvent(new Event('input', { bubbles: true, composed: true }));
    input.dispatchEvent(
      new Event('change', { bubbles: true, composed: false }),
    );

    muteIcon.toggleAttribute('hidden', input.value != input.min);
    unmuteIcon.toggleAttribute('hidden', input.value == input.min);
  });

  input.addEventListener('input', () => {
    muteIcon.toggleAttribute('hidden', input.value != input.min);
    unmuteIcon.toggleAttribute('hidden', input.value == input.min);
  });
</script>
