{{- with resources.Get "iife/main.js" }}
  {{- if hugo.IsProduction }}
    {{- with . | fingerprint }}
      <script
        type="module"
        src="{{ .RelPermalink }}"
        integrity="{{ .Data.Integrity }}"
      ></script>
    {{- end }}
  {{- else }}
    <script type="module" src="{{ .RelPermalink }}"></script>

    {{- with resources.Get "iife/main.js.map" }}
      <!--{{ .RelPermalink }}-->
    {{- end }}
  {{- end }}
{{- end }}

{{- if hugo.IsProduction }}
  <script type="module">
    window.addEventListener('load', () => {
      const script = document.createElement('script');
      script.setAttribute('src', 'https://gc.zgo.at/count.v5.js');
      script.setAttribute('crossorigin', 'anonymous');
      script.setAttribute('data-goatcounter', '{{ site.Params.goatcounter }}');
      script.setAttribute('integrity', 'sha384-atnOLvQb9t+jTSipvd75X2yginT4PjVbqDdlJAmxMm+wYElFmeR6EmLP5bYeoRVQ');
      document.head.appendChild(script);
    });
  </script>
{{- end }}
