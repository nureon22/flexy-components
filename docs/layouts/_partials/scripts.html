{{- with resources.Get "iife/main.js" }}
  {{- if hugo.IsProduction }}
    {{- with . | fingerprint }}
      <script
        type="module"
        src="{{ .RelPermalink }}"
        integrity="{{ .Data.Integrity }}"
      ></script>
    {{- end }}
  {{- else }}
    <script type="module" src="{{ .RelPermalink }}"></script>

    {{- with resources.Get "iife/main.js.map" }}
      <!--{{ .RelPermalink }}-->
    {{- end }}
  {{- end }}
{{- end }}

{{- if hugo.IsProduction }}
  <script type="module">
    window.addEventListener('load', () => {
      const script = document.createElement('script');
      script.setAttribute('src', 'https://cloud.umami.is/script.js');
      script.setAttribute('crossorigin', 'anonymous');
      script.setAttribute('data-website-id', '{{ site.Params.umami_id }}')
      document.head.appendChild(script);
    });
  </script>
{{- end }}
